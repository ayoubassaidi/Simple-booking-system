{% extends "dashboard_base.html" %}

{% block dashboard_content %}

<div class="main-section">
    <h4 class="section-title">
        <i class="bi bi-bell"></i> Notifications
    </h4>

    <!-- Notifications Stats -->
    <div class="notifications-stats-grid">
        <div class="notification-stat-card">
            <div class="stat-icon-notif">
                <i class="bi bi-bell-fill"></i>
            </div>
            <div class="stat-content-notif">
                <h3>{{ total_count }}</h3>
                <p>Total Notifications</p>
            </div>
        </div>

        <div class="notification-stat-card unread">
            <div class="stat-icon-notif">
                <i class="bi bi-envelope-fill"></i>
            </div>
            <div class="stat-content-notif">
                <h3>{{ unread_count }}</h3>
                <p>Unread Messages</p>
            </div>
        </div>
    </div>

    <!-- Notification Actions -->
    {% if notifications %}
    <div class="notification-actions-bar">
        <a href="?mark_all_read=true" class="btn-mark-all-read">
            <i class="bi bi-check-all"></i>
            Mark All as Read
        </a>
    </div>
    {% endif %}

    <!-- Notifications List -->
    {% if notifications %}
    <div class="notifications-container">
        {% for notification in notifications %}
        <div class="notification-card {% if not notification.is_read %}unread{% endif %}">
            <!-- Notification Icon Based on Type -->
            <div class="notification-icon-wrapper notification-type-{{ notification.notification_type }}">
                {% if notification.notification_type == 'booking' %}
                    <i class="bi bi-calendar-check-fill"></i>
                {% elif notification.notification_type == 'cancellation' %}
                    <i class="bi bi-x-circle-fill"></i>
                {% elif notification.notification_type == 'reminder' %}
                    <i class="bi bi-alarm-fill"></i>
                {% elif notification.notification_type == 'system' %}
                    <i class="bi bi-gear-fill"></i>
                {% elif notification.notification_type == 'message' %}
                    <i class="bi bi-chat-dots-fill"></i>
                {% else %}
                    <i class="bi bi-bell-fill"></i>
                {% endif %}
            </div>

            <!-- Notification Content -->
            <div class="notification-content">
                <div class="notification-header">
                    <h6 class="notification-title">{{ notification.title }}</h6>
                    <span class="notification-time">
                        <i class="bi bi-clock"></i>
                        {{ notification.created_at|timesince }} ago
                    </span>
                </div>
                <p class="notification-message">{{ notification.message }}</p>

                <div class="notification-type-badge badge-{{ notification.notification_type }}">
                    {{ notification.get_notification_type_display }}
                </div>
            </div>

            <!-- Notification Actions -->
            <div class="notification-actions">
                {% if not notification.is_read %}
                <a href="?mark_read={{ notification.id }}" class="notification-action-btn" title="Mark as read">
                    <i class="bi bi-check2"></i>
                </a>
                {% endif %}

                {% if notification.link %}
                <a href="{{ notification.link }}" class="notification-action-btn" title="View details">
                    <i class="bi bi-arrow-right-circle"></i>
                </a>
                {% endif %}

                <a href="?delete={{ notification.id }}" class="notification-action-btn delete" title="Delete" onclick="return confirm('Are you sure you want to delete this notification?')">
                    <i class="bi bi-trash"></i>
                </a>
            </div>

            <!-- Unread Indicator -->
            {% if not notification.is_read %}
            <div class="unread-indicator"></div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <!-- Empty State -->
    <div class="empty-state-notifications">
        <div class="empty-icon">
            <i class="bi bi-bell-slash"></i>
        </div>
        <h5>No Notifications Yet</h5>
        <p>You're all caught up! Check back later for new notifications.</p>
    </div>
    {% endif %}
</div>

{% endblock %}
